{% extends "base.html" %}
{% block title %}ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸{% endblock %}

{% block content %}
<section class="content">
  <h1 class="title">ãƒˆãƒƒãƒ—ãƒ¡ãƒ‹ãƒ¥ãƒ¼</h1>
  <p id="datetime" class="datetime"></p>

  <div class="menu-container">

    <!-- ãƒœã‚¿ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
    <div class="menu-box">
      <div class="buttons-vertical">
        <a href="{% url 'telles:student_signup' %}" class="action-card">
          <div class="action-icon">+</div>
          <div class="action-text">æ–°è¦ç™»éŒ²</div>
        </a>
        <a href="{% url 'telles:calendar' %}" class="action-card">
          <div class="action-icon">ğŸ“‹</div>
          <div class="action-text">å‡ºæ¬ ç°¿</div>
        </a>
        <a href="{% url 'telles:attendance_summary' %}" class="action-card">
          <div class="action-icon">ğŸ“Š</div>
          <div class="action-text">å‡ºæ¬ é›†è¨ˆ</div>
        </a>
      </div>
    </div>

    <!-- ã‚¯ãƒ©ã‚¹ä¸€è¦§ -->
    <div class="class-box">
      <h3>ã‚¯ãƒ©ã‚¹ä¸€è¦§</h3>

      <span id="today"></span>

      <table class="class-table-top">
        <thead>
          <tr>
            <th>å­¦ç§‘</th>
            <th>ç•ªå·</th>
            <th>åå‰</th>
            <th>å‡ºå¸­çŠ¶æ³</th>
          </tr>
        </thead>

        <tbody>
  {% for student in students %}
  <tr>
    <td>
      {% if student.department %}
        {{ student.department.department }}
      {% else %}
        æœªæ‰€å±
      {% endif %}
    </td>
    <td>{{ student.student_number }}</td>
    <td>
      <a href="{% url 'telles:profile' student.id %}">
        {{ student.student_name }}
      </a>
    </td>


            <td>
          {% if not student.user.is_active %}
            <span class="student-inactive-text">é€€å­¦</span>
          {% elif student.attendance %}
            <a href="{% url 'telles:detail' student.id date %}">
              {{ student.attendance.get_status_display }}
            </a>
          {% else %}
            -
          {% endif %}
        </td>
          </tr>

          {% empty %}
          <tr>
            <td colspan="4" class="empty">ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

  </div>
</section>

<script>
  const today = new Date();
  const year = today.getFullYear();
  const month = today.getMonth() + 1;
  const day = today.getDate();
  document.getElementById("today").textContent =
    `${year}å¹´${month}æœˆ${day}æ—¥`;
</script>
{% endblock %}
