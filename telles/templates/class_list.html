{% extends "base.html" %}

{% block title %}ã‚¯ãƒ©ã‚¹ä¸€è¦§{% endblock %}

{% block content %}
<div class="page-container">

  <h2 class="title">ã‚¯ãƒ©ã‚¹ä¸€è¦§</h2>

  <span id="today"></span>

  {% if students %}
  <table class="class-table-detail">
    <thead>
      <tr>
        <th>ç•ªå·</th>
        <th>åå‰</th>
        <th>å‡ºå¸­çŠ¶æ³</th>
        <th>é€šçŸ¥</th>
      </tr>
    </thead>

    <tbody>
      {% for student in students %}
      <tr
        class="{% if not student.is_active %}student-inactive{% endif %}"
        {% if student.id in notify_map %}
          style="background-color: #fff0f0;"
        {% endif %}
      >
        <!-- ç•ªå· -->
        <td>{{ student.student_number }}</td>

        <!-- åå‰ -->
        <td>
          {% if student.is_active %}
            {{ student.student_name }}
          {% else %}
            {{ student.student_name }}
          {% endif %}
        </td>

        <!-- å‡ºå¸­çŠ¶æ³ -->
        <!-- å‡ºå¸­çŠ¶æ³ -->
        <td>
          {% if not student.is_active %}
            <span style="color: gray; font-weight: bold;">é€€å­¦</span>

          {% elif student.attendance %}
            <a href="{% url 'telles:detail' student.id date %}">
              {{ student.attendance.get_status_display }}
            </a>

          {% else %}
            -
          {% endif %}
        </td>

        <!-- é€šçŸ¥ -->
        <td>
          {% if student.id in notify_map %}
            <span style="color: red; font-weight: bold;">ğŸ””</span>
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  {% else %}
    <p class="empty">ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</p>
  {% endif %}

</div>

<script>
  const today = new Date();
  const year = today.getFullYear();
  const month = today.getMonth() + 1;
  const day = today.getDate();
  document.getElementById("today").textContent =
    `${year}å¹´${month}æœˆ${day}æ—¥`;
</script>
{% endblock %}
