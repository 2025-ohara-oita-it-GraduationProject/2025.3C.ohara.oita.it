{% extends "base.html" %}
{% block title %}学生サインアップ{% endblock %}

{% block content %}


<section class="content">
    <h1 class="title">学生サインアップ</h1>

    <form method="POST">
        {% csrf_token %}

        <div class="signup-box">

            <!-- ヘッダー -->
            <div class="signup-header">
                <div class="signup-cell signup-wide">入学年度</div>
                <div class="signup-cell signup-wide">学科</div>
                <div class="signup-cell signup-wide">何年制</div>
                <div class="signup-cell signup-wide">ID</div>
                <div class="signup-cell signup-wide">パスワード</div>
                <div class="signup-cell signup-wide">番号</div>
                <div class="signup-cell signup-wide">名前</div>
                <div class="signup-cell signup-wide">削除</div>
            </div>

            <!-- 本体 -->
            <div class="signup-body" id="signup-body">

                <div class="signup-row">
                    <div class="signup-cell signup-wide">
                        {% if is_year_only %}
                            <input type="text" name="academic_year[]" placeholder="例: 2024" maxlength="4" required>
                        {% else %}
                            <input type="text" value="{{ selected_academic_year }}" disabled>
                            <input type="hidden" name="academic_year[]" value="{{ selected_academic_year }}">
                        {% endif %}
                    </div>

                    <div class="signup-cell signup-wide">
                        {% if is_year_only %}
                            <select name="department[]" required>
                                <option value="">選択してください</option>
                                {% for c in class_list %}
                                    <option value="{{ c.department }}">{{ c.department }}</option>
                                {% endfor %}
                            </select>
                        {% else %}
                            <input type="text" value="{{ selected_department }}" disabled>
                            <input type="hidden" name="department[]" value="{{ selected_department }}">
                        {% endif %}
                    </div>


                    <div class="signup-cell signup-wide">
                        {% if is_year_only %}
                            <select name="course_years[]" required>
                                <option value="">選択してください</option>
                                <option value="1">1年制</option>
                                <option value="2">2年制</option>
                                <option value="3">3年制</option>
                            </select>
                        {% else %}
                            <input type="text" value="{{ selected_course_years }}年制" disabled>
                            <input type="hidden" name="course_years[]" value="{{ selected_course_years }}">
                        {% endif %}
                    </div>



                    <div class="signup-cell signup-wide">
                        <input type="text" name="student_id[]" placeholder="ID" required>
                    </div>

                    <div class="signup-cell signup-wide">
                        <input type="password" name="password[]" placeholder="パスワード" required>
                    </div>

                    <div class="signup-cell signup-wide">
                        <input type="text" name="number[]" placeholder="出席番号" required>
                    </div>

                    <div class="signup-cell signup-wide">
                        <input type="text" name="fullname[]" placeholder="氏名" required>
                    </div>

                    <div class="signup-cell signup-wide">
                    </div>
                </div>
            </div><!-- signup-body END -->

        </div><!-- signup-box END -->

        <!-- エラーメッセージ（入力欄下、ボタン上） -->
        <div class="signup-errors">
            {% if form.errors.department %}
                <div class="field-error-dept">選択してください。</div>
            {% endif %}
            {% if form.errors.classroom %}
                <div class="field-error-class">選択してください。</div>
            {% endif %}
        </div>

        <!-- ボタン -->
        <div class="signup-buttons">
            <button type="button" onclick="location.href='{% url 'telles:classroom' %}'">
                クラス登録
            </button>
            <button type="button" onclick="addRow({{ is_year_only|yesno:'true,false' }})">+ 行を追加</button>

            <button type="submit">登録する</button>
        </div>

    </form>
</section>
{% endblock %}
